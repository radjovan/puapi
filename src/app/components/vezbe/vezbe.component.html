<br>
<div class="container">
  <div class="vezbe-container">
    <form [formGroup]="vezbaForm" (ngSubmit)="addVezba()" class="form-container">
      <h1>Kreiraj Novu Vežbu</h1>

      <label for="predmet">Predmet</label>
      <select id="predmet" formControlName="idPredmeta" (change)="onPredmetChange($event)" required>
        <option *ngFor="let predmet of predmeti" [value]="predmet.id">{{ predmet.naziv + " (" + predmet.razred + ". razred)" }}</option>
      </select>

      <label for="naziv">Naziv vežbe</label>
      <input type="text" id="naziv" formControlName="naziv" required>

      <label for="trajanjeVezbe">Trajanje vežbe (u sekundama)</label>
      <input type="number" id="trajanjeVezbe" formControlName="trajanjeVezbe" required>

      <label for="nivo">Odabir zadataka za vežbu</label>
      Prikaži samo moje zadatke <input type="checkbox" [value]="onlyMyZadaci" (change)="showMyZadaci()">
      Izaberi nivo 
      <select id="nivo" formControlName="selectedNivo" required>
        <option [value]="0">Svi Nivoi</option>
        <option [value]="1">Osnovni Nivo</option>
        <option [value]="2">Srednji Nivo</option>
        <option [value]="3">Napredni Nivo</option>
      </select>
      Teme
      <select id="tema" formControlName="idTeme" required>
        <option [value]="0">Sve teme</option>
        <option *ngFor="let tema of teme" [value]="tema.id">{{ tema.naziv }}</option>
      </select>
      <div class="zadaci-section">
        <!--<label>Iza:</label>-->
        <div *ngFor="let zadatak of filteredZadaci">
          <div *ngIf="onlyMyZadaci == false || (onlyMyZadaci == true && zadatak.idKreatora == currentUserId)" [ngClass]="getZadatakClass(zadatak.nivo)">
                <div class="zadaci-naziv"><label>{{ zadatak.opis }}</label></div>
                <label class="zadaci-level">{{ zadatak.nivo == 1 ? "Osnovni Nivo" : zadatak.nivo == 2 ? "Srednji Nivo" : "Napredni Nivo" }}</label>
                <input class="zadaci-checkbox" type="checkbox" [value]="zadatak.id" (change)="toggleZadatak(zadatak.id, $event)">
                <div class="actions">
                  <button class="zadaci-details" type="button" (click)="openZadatakModal(zadatak)">Pogledaj zadatak</button>
                </div>
          </div>
        </div>
      </div>

      <div class="actions">
        <button type="submit">Sačuvaj vežbu</button>
      </div>
    </form>
  </div>

  <div class="modal" *ngIf="showZadatakModal">
    <div class="modal-content form-container">

      <div class="image-modal" *ngIf="showImageModal" (click)="closeImageModal()">
        <span class="image-modal-close">&times;</span>
        <div class="image-modal-content">
            <img [src]="selectedImage" alt="Full size image">
        </div>
      </div>
      <span class="close" (click)="closeZadatakModal()">&times;</span>
      <h2>{{ selectedZadatak?.opis }}</h2>
      <p><strong>Tekst zadatka:</strong></p>
      <p *ngIf="!selectedZadatak?.latex">{{ selectedZadatak?.tekst }}</p>
      <div class="latex-output" *ngIf="selectedZadatak?.latex">
      <div [innerHTML]="renderLatex(selectedZadatak?.tekst)"></div>
      </div>                
      <img *ngIf="selectedZadatak?.picture == true" [src]="selectedZadatak?.path" class="task-image">

      <h3>Odgovori:</h3>
      <ul>
        <div *ngFor="let odgovor of selectedZadatak?.odgovori">        
          <div *ngIf="odgovor.path">
            <label>{{ odgovor.tekst}}</label> 
          <img  [src]="odgovor.path" class="task-image" (click)="openImageModal(odgovor.path)">
        </div>
      </div>
      </ul>

      <h3>Teorijski podsetnik:</h3>
      <p *ngIf="!selectedZadatak?.latex">{{ selectedZadatak?.definicija?.tekst }}</p>
      <div class="latex-output" *ngIf="selectedZadatak?.definicija?.latex">
      <div [innerHTML]="renderLatex(selectedZadatak?.definicija?.tekst)"></div>
      <div *ngIf="selectedZadatak?.definicija?.path">
        <img  [src]="selectedZadatak?.definicija?.path" class="task-image" (click)="openImageModal(selectedZadatak?.definicija?.path)">
      </div>
      </div> 

      <h3>Pomoć za približan zadatak</h3>
      <p>{{ selectedZadatak?.hint?.tekst }}</p>
      <div *ngIf="selectedZadatak?.hint?.path">
        <img  [src]="selectedZadatak?.hint?.path" class="task-image" (click)="openImageModal(selectedZadatak?.hint?.path)">
        </div>
    </div>
  </div>
</div>
